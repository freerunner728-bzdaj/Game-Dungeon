<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { margin:0; background:#000; color:white; text-align:center; font-family:sans-serif; }
canvas { background:#111; display:block; margin:auto; }
.controls { position:fixed; bottom:20px; width:100%; }
button {
  width:60px; height:60px; margin:5px;
  font-size:20px; border:none; border-radius:15px;
  background:#222; color:white;
}
</style>
</head>
<body>

<canvas id="game" width="300" height="300"></canvas>

<div class="controls">
  <div>
    <button onclick="move(0,-1)">‚Üë</button>
  </div>
  <div>
    <button onclick="move(-1,0)">‚Üê</button>
    <button onclick="attack()">‚öîÔ∏è</button>
    <button onclick="move(1,0)">‚Üí</button>
  </div>
  <div>
    <button onclick="usePotion()">üß™</button>
    <button onclick="move(0,1)">‚Üì</button>
  </div>
</div>

<script>
let size = 10;
let tile = 30;

let player = {x:1,y:1,hp:20,potions:1};
let enemy = {x:8,y:8,hp:10};

function draw(){
  let c = document.getElementById("game");
  let ctx = c.getContext("2d");
  ctx.clearRect(0,0,300,300);

  for(let y=0;y<size;y++){
    for(let x=0;x<size;x++){
      ctx.fillStyle="#222";
      ctx.fillRect(x*tile,y*tile,tile-1,tile-1);
    }
  }

  ctx.fillStyle="blue";
  ctx.fillRect(player.x*tile,player.y*tile,tile-2,tile-2);

  ctx.fillStyle="red";
  ctx.fillRect(enemy.x*tile,enemy.y*tile,tile-2,tile-2);

  ctx.fillStyle="white";
  ctx.fillText("HP:"+player.hp,10,10);
}

function move(dx,dy){
  player.x=Math.max(0,Math.min(size-1,player.x+dx));
  player.y=Math.max(0,Math.min(size-1,player.y+dy));
  enemyTurn();
  save();
  draw();
}

function attack(){
  if(Math.abs(player.x-enemy.x)+Math.abs(player.y-enemy.y)==1){
    enemy.hp-=3;
    if(enemy.hp<=0){
      alert("Enemy defeated üî•");
      enemy.x=8; enemy.y=8; enemy.hp=10;
    }
  }
  enemyTurn();
  save();
  draw();
}

function usePotion(){
  if(player.potions>0){
    player.hp+=5;
    player.potions--;
  }
  save();
  draw();
}

function enemyTurn(){
  if(Math.random()<0.5){
    if(enemy.x<player.x) enemy.x++;
    else if(enemy.x>player.x) enemy.x--;
  } else {
    if(enemy.y<player.y) enemy.y++;
    else if(enemy.y>player.y) enemy.y--;
  }

  if(enemy.x==player.x && enemy.y==player.y){
    player.hp-=2;
    if(player.hp<=0){
      alert("You died üíÄ");
      reset();
    }
  }
}

function save(){
  localStorage.setItem("dungeonSave", JSON.stringify({player,enemy}));
}

function load(){
  let s = localStorage.getItem("dungeonSave");
  if(s){
    let data = JSON.parse(s);
    player=data.player;
    enemy=data.enemy;
  }
}

function reset(){
  player={x:1,y:1,hp:20,potions:1};
  enemy={x:8,y:8,hp:10};
  save();
}

load();
draw();
</script>

</body>
</html>